<!DOCTYPE html>
<html lang="en" id="app-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">AI Project Generator - Claude Code</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.300.0/lucide.min.css" rel="stylesheet">
    <style>
        /* Custom styles for better UX */
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .language-badge {
            @apply inline-flex items-center px-2 py-1 rounded-full text-xs font-medium;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-divider {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        .checkbox-group label {
            transition: all 0.2s ease;
        }

        .checkbox-group label:hover {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            padding: 0.25rem;
        }

        .form-section {
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.02);
        }

        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            min-width: 300px;
        }

        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, #FF8F00, #FFA726);
            border-radius: 2px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-600 via-red-500 to-amber-500 min-h-screen" style="background: linear-gradient(135deg, #FF5722 0%, #FF7043 25%, #FF8A65 50%, #FFAB40 75%, #FFCC80 100%);">
    <div id="app" class="container mx-auto px-4 py-8">
        <!-- Language Switcher Header -->
        <header class="mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h1 id="main-title" class="text-4xl font-bold text-white mb-2 flex items-center gap-3">
                        <svg class="w-10 h-10" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 2V8H15V2H9ZM11 4H13V6H11V4ZM2 22H22V20H2V22ZM3 8.5C3 6.57 4.57 5 6.5 5S10 6.57 10 8.5 8.43 12 6.5 12 3 10.43 3 8.5ZM5 8.5C5 9.33 5.67 10 6.5 10S8 9.33 8 8.5 7.33 7 6.5 7 5 7.67 5 8.5ZM14 8.5C14 6.57 15.57 5 17.5 5S21 6.57 21 8.5 19.43 12 17.5 12 14 10.43 14 8.5ZM16 8.5C16 9.33 16.67 10 17.5 10S19 9.33 19 8.5 18.33 7 17.5 7 16 7.67 16 8.5ZM12 13C14.21 13 16 14.79 16 17S14.21 21 12 21 8 19.21 8 17 9.79 13 12 13ZM12 15C10.9 15 10 15.9 10 17S10.9 19 12 19 14 18.1 14 17 13.1 15 12 15Z"/>
                        </svg>
                        AI Project Generator
                    </h1>
                    <p id="main-subtitle" class="text-orange-100">
                        Generate optimized documentation-driven prompts for Claude Code
                    </p>
                </div>
                <div class="language-switcher flex gap-2">
                    <button onclick="switchLanguage('en')"
                            class="px-4 py-2 rounded-lg bg-white/20 text-white hover:bg-white/30 transition-all flex items-center gap-2"
                            id="lang-en">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        English
                    </button>
                    <button onclick="switchLanguage('zh-CN')"
                            class="px-4 py-2 rounded-lg bg-white/20 text-white hover:bg-white/30 transition-all flex items-center gap-2"
                            id="lang-zh">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-2V2c0-.55-.45-1-1-1s-1 .45-1 1v2H8V2c0-.55-.45-1-1-1s-1 .45-1 1v2H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H4V8h16v12z"/>
                        </svg>
                        ç®€ä½“ä¸­æ–‡
                    </button>
                </div>
            </div>
            <!-- Progress Bar -->
            <div class="mt-4 bg-white/10 rounded-full h-1">
                <div id="progress-bar" class="progress-bar w-0"></div>
            </div>
        </header>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Configuration Panel (Left) -->
            <div class="lg:col-span-1">
                <div class="glass-effect rounded-xl p-6 text-white h-[80vh] flex flex-col">
                    <h2 id="config-title" class="text-xl font-semibold mb-6 flex items-center gap-2">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                        </svg>
                        <span data-i18n="configTitle">Project Configuration</span>
                    </h2>

                    <!-- Configuration Form -->
                    <div class="flex-1 overflow-y-auto pr-2" style="scrollbar-width: thin; scrollbar-color: rgba(255,255,255,0.3) transparent;">
                    <form id="project-form" class="space-y-6">
                        <!-- Project Mode Section -->
                        <div class="form-section">
                            <label class="block text-sm font-medium mb-3 flex items-center gap-2">
                                ğŸš€ <span data-i18n="projectMode">Project Mode</span>
                            </label>
                            <div class="space-y-2">
                                <label class="flex items-center space-x-3 cursor-pointer">
                                    <input type="radio" name="projectMode" value="new" checked
                                           class="text-blue-500 focus:ring-blue-500">
                                    <span data-i18n="newProject">New Project</span>
                                    <span class="text-xs text-blue-300" data-i18n="newProjectDesc">(Generate complete documentation system)</span>
                                </label>
                                <label class="flex items-center space-x-3 cursor-pointer">
                                    <input type="radio" name="projectMode" value="iteration"
                                           class="text-blue-500 focus:ring-blue-500">
                                    <span data-i18n="versionIteration">Version Iteration</span>
                                    <span class="text-xs text-blue-300" data-i18n="iterationDesc">(Generate new version based on existing docs)</span>
                                </label>
                            </div>
                        </div>

                        <!-- Version Iteration Settings (Hidden by default) -->
                        <div id="iteration-settings" class="form-section hidden">
                            <label class="block text-sm font-medium mb-3 flex items-center gap-2">
                                ğŸ“Š <span data-i18n="versionSettings">Version Settings</span>
                            </label>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs text-blue-200 mb-1" data-i18n="currentVersion">Current Version</label>
                                    <select id="currentVersion" class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                        <option value="v1.0">v1.0</option>
                                        <option value="v1.1">v1.1</option>
                                        <option value="v1.2">v1.2</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs text-blue-200 mb-1" data-i18n="targetVersion">Target Version</label>
                                    <input type="text" id="targetVersion" value="v1.3"
                                           class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                </div>
                            </div>
                            <div class="mt-3">
                                <label class="block text-xs text-blue-200 mb-1" data-i18n="changeType">Change Type</label>
                                <select id="changeType" class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                    <option value="feature" data-i18n="featureAddition">Feature Addition</option>
                                    <option value="modification" data-i18n="featureModification">Feature Modification</option>
                                    <option value="architecture" data-i18n="architectureOptimization">Architecture Optimization</option>
                                    <option value="bugfix" data-i18n="bugFix">Bug Fix</option>
                                </select>
                            </div>
                        </div>

                        <!-- Language Settings -->
                        <div class="form-section">
                            <label class="block text-sm font-medium mb-3 flex items-center gap-2">
                                ğŸŒ <span data-i18n="languageSettings">Language Settings</span>
                            </label>
                            <div class="grid grid-cols-1 gap-3">
                                <div>
                                    <label class="block text-xs text-blue-200 mb-1" data-i18n="docLanguage">Documentation Language</label>
                                    <select id="docLanguage" class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                        <option value="en">English</option>
                                        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                                        <option value="bilingual">Bilingual åŒè¯­</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs text-blue-200 mb-1" data-i18n="codeComments">Code Comments</label>
                                    <select id="codeComments" class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                        <option value="en">English</option>
                                        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                                        <option value="bilingual">Bilingual åŒè¯­</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Project Information -->
                        <div class="form-section">
                            <label class="block text-sm font-medium mb-3 flex items-center gap-2">
                                ğŸ“ <span data-i18n="projectInfo">Project Information</span>
                            </label>
                            <div class="space-y-3">
                                <input type="text" id="projectName"
                                       placeholder="Enter project name..."
                                       data-i18n-placeholder="projectNamePlaceholder"
                                       class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-blue-200 border border-white/30 focus:border-blue-400 focus:ring-2 focus:ring-blue-400/50">
                                <textarea id="projectDescription" rows="3"
                                          placeholder="Describe your project requirements and goals..."
                                          data-i18n-placeholder="projectDescPlaceholder"
                                          class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-blue-200 border border-white/30 focus:border-blue-400 focus:ring-2 focus:ring-blue-400/50"></textarea>
                                <select id="projectType" class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                    <option value="web" data-i18n="webApp">Web Application</option>
                                    <option value="api" data-i18n="apiService">API Service</option>
                                    <option value="mobile" data-i18n="mobileApp">Mobile Application</option>
                                    <option value="desktop" data-i18n="desktopApp">Desktop Application</option>
                                    <option value="library" data-i18n="library">Library/Framework</option>
                                    <option value="microservice" data-i18n="microservice">Microservice</option>
                                </select>
                            </div>
                        </div>

                        <!-- Document Configuration -->
                        <div class="form-section">
                            <label class="block text-sm font-medium mb-3 flex items-center gap-2">
                                ğŸ“š <span data-i18n="documentsConfig">Documents Configuration</span>
                            </label>

                            <!-- Core Documents -->
                            <div class="mb-4">
                                <h4 class="text-sm font-medium text-blue-200 mb-2" data-i18n="coreDocuments">Core Documents (Required)</h4>
                                <div class="checkbox-group space-y-2">
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" checked disabled class="rounded text-blue-500">
                                        <span class="text-sm">CLAUDE.md</span>
                                        <span class="language-badge bg-green-500/20 text-green-300" data-i18n="required">Required</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="prd" checked class="rounded text-blue-500">
                                        <span class="text-sm">PRD.md</span>
                                        <span class="language-badge bg-blue-500/20 text-blue-300" data-i18n="recommended">Recommended</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="architecture" checked class="rounded text-blue-500">
                                        <span class="text-sm">ARCHITECTURE.md</span>
                                        <span class="language-badge bg-blue-500/20 text-blue-300" data-i18n="recommended">Recommended</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="api" checked class="rounded text-blue-500">
                                        <span class="text-sm">API.md</span>
                                        <span class="language-badge bg-blue-500/20 text-blue-300" data-i18n="recommended">Recommended</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Professional Documents -->
                            <div class="mb-4">
                                <h4 class="text-sm font-medium text-blue-200 mb-2" data-i18n="professionalDocuments">Professional Documents (Optional)</h4>
                                <div class="checkbox-group space-y-2">
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="ux" class="rounded text-blue-500">
                                        <span class="text-sm">UX.md</span>
                                        <span class="language-badge bg-purple-500/20 text-purple-300" data-i18n="optional">Optional</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="security" class="rounded text-blue-500">
                                        <span class="text-sm">SECURITY.md</span>
                                        <span class="language-badge bg-purple-500/20 text-purple-300" data-i18n="optional">Optional</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="performance" class="rounded text-blue-500">
                                        <span class="text-sm">PERFORMANCE.md</span>
                                        <span class="language-badge bg-purple-500/20 text-purple-300" data-i18n="optional">Optional</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="deployment" class="rounded text-blue-500">
                                        <span class="text-sm">DEPLOYMENT.md</span>
                                        <span class="language-badge bg-purple-500/20 text-purple-300" data-i18n="optional">Optional</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Workflow Documents -->
                            <div>
                                <h4 class="text-sm font-medium text-blue-200 mb-2" data-i18n="workflowDocuments">Workflow Documents (Recommended)</h4>
                                <div class="checkbox-group space-y-2">
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="testing" class="rounded text-blue-500">
                                        <span class="text-sm">TESTING.md</span>
                                        <span class="language-badge bg-orange-500/20 text-orange-300" data-i18n="workflow">Workflow</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="development" class="rounded text-blue-500">
                                        <span class="text-sm">DEVELOPMENT.md</span>
                                        <span class="language-badge bg-orange-500/20 text-orange-300" data-i18n="workflow">Workflow</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="docs" value="review" class="rounded text-blue-500">
                                        <span class="text-sm">REVIEW.md</span>
                                        <span class="language-badge bg-orange-500/20 text-orange-300" data-i18n="workflow">Workflow</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Git & Automation Configuration -->
                        <div class="form-section">
                            <label class="block text-sm font-medium mb-3 flex items-center gap-2">
                                ğŸ”§ <span data-i18n="automationConfig">Automation Configuration</span>
                            </label>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs text-blue-200 mb-1" data-i18n="branchStrategy">Branching Strategy</label>
                                    <select id="branchStrategy" class="w-full p-2 rounded bg-white/20 text-white border border-white/30">
                                        <option value="gitflow">GitFlow (main/develop/feature)</option>
                                        <option value="github">GitHub Flow (main/feature)</option>
                                        <option value="custom">Custom Strategy</option>
                                    </select>
                                </div>
                                <div class="checkbox-group space-y-2">
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="automation" value="hooks" checked class="rounded text-blue-500">
                                        <span class="text-sm" data-i18n="claudeHooks">Claude Code Hooks</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="automation" value="cicd" checked class="rounded text-blue-500">
                                        <span class="text-sm" data-i18n="cicdPipeline">CI/CD Pipeline</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="automation" value="testing" checked class="rounded text-blue-500">
                                        <span class="text-sm" data-i18n="autoTesting">Automated Testing</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" name="automation" value="quality" checked class="rounded text-blue-500">
                                        <span class="text-sm" data-i18n="qualityChecks">Quality Checks</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Generate Button -->
                        <button type="button" onclick="generatePrompt()"
                                id="generate-btn"
                                class="w-full py-4 bg-gradient-to-r from-orange-600 to-red-500 text-white rounded-lg font-semibold hover:from-orange-700 hover:to-red-600 transition-all transform hover:scale-105 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none" style="background: linear-gradient(90deg, #FF5722, #FF7043);"
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M2.81 2.81L1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41L2.81 2.81zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20zM7.94 5.12L6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.45-1.45C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12z"/>
                            </svg>
                            <span data-i18n="generatePrompt">Generate Prompt</span>
                        </button>
                    </form>
                    </div>
                </div>
            </div>

            <!-- Preview Panel (Middle & Right) -->
            <div class="lg:col-span-2">
                <div class="glass-effect rounded-xl p-6 text-white h-full">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="preview-title" class="text-xl font-semibold flex items-center gap-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                            <span data-i18n="previewTitle">Generated Prompt Preview</span>
                        </h2>
                        <div class="flex gap-2">
                            <button onclick="copyPrompt()"
                                    class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-all flex items-center gap-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                </svg>
                                <span data-i18n="copyToClipboard">Copy to Clipboard</span>
                            </button>
                            <button onclick="downloadConfig()"
                                    class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all flex items-center gap-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                                </svg>
                                <span data-i18n="downloadConfig">Download Config</span>
                            </button>
                            <button onclick="generateProject()"
                                    class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-all flex items-center gap-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                </svg>
                                <span data-i18n="generateProject">Generate Project</span>
                            </button>
                        </div>
                    </div>

                    <div class="bg-black/30 rounded-lg p-4 h-96 overflow-y-auto relative">
                        <pre id="prompt-preview" class="text-sm text-orange-50 whitespace-pre-wrap">
<!-- Generated prompt will appear here -->
<!-- ç”Ÿæˆçš„æç¤ºå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
Click "Generate Prompt" to see your customized Claude Code prompt
ç‚¹å‡»"ç”Ÿæˆæç¤º"æŸ¥çœ‹æ‚¨å®šåˆ¶çš„Claude Codeæç¤º
                        </pre>
                        <div id="loading-indicator" class="hidden absolute inset-0 flex items-center justify-center bg-black/70 rounded-lg">
                            <div class="text-white text-center">
                                <div class="animate-spin w-8 h-8 border-2 border-orange-300 border-t-transparent rounded-full mx-auto mb-2"></div>
                                <span data-i18n="generating">Generating...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Bar -->
                    <div class="mt-4 flex justify-between text-sm text-orange-100">
                        <span data-i18n="characters">Characters: <span id="char-count">0</span></span>
                        <span data-i18n="estimatedTokens">Estimated Tokens: <span id="token-count">0</span></span>
                        <span data-i18n="qualityScore">Quality Score: <span id="quality-score">-</span>/100</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentLang = 'en';
        let projectConfig = {
            mode: 'new',
            name: '',
            description: '',
            type: 'web',
            docLanguage: 'en',
            codeComments: 'en',
            selectedDocs: ['prd', 'architecture', 'api'],
            branchStrategy: 'gitflow',
            automation: ['hooks', 'cicd', 'testing', 'quality'],
            currentVersion: 'v1.0',
            targetVersion: 'v1.3',
            changeType: 'feature'
        };

        // Internationalization
        const i18n = {
            en: {
                ui: {
                    title: "ğŸ¤– AI Project Generator",
                    subtitle: "Generate optimized documentation-driven prompts for Claude Code",
                    configTitle: "Project Configuration",
                    projectMode: "Project Mode",
                    newProject: "New Project",
                    newProjectDesc: "(Generate complete documentation system)",
                    versionIteration: "Version Iteration",
                    iterationDesc: "(Generate new version based on existing docs)",
                    versionSettings: "Version Settings",
                    currentVersion: "Current Version",
                    targetVersion: "Target Version",
                    changeType: "Change Type",
                    featureAddition: "Feature Addition",
                    featureModification: "Feature Modification",
                    architectureOptimization: "Architecture Optimization",
                    bugFix: "Bug Fix",
                    languageSettings: "Language Settings",
                    docLanguage: "Documentation Language",
                    codeComments: "Code Comments",
                    projectInfo: "Project Information",
                    projectNamePlaceholder: "Enter project name...",
                    projectDescPlaceholder: "Describe your project requirements and goals...",
                    webApp: "Web Application",
                    apiService: "API Service",
                    mobileApp: "Mobile Application",
                    desktopApp: "Desktop Application",
                    library: "Library/Framework",
                    microservice: "Microservice",
                    documentsConfig: "Documents Configuration",
                    coreDocuments: "Core Documents (Required)",
                    professionalDocuments: "Professional Documents (Optional)",
                    workflowDocuments: "Workflow Documents (Recommended)",
                    required: "Required",
                    recommended: "Recommended",
                    optional: "Optional",
                    workflow: "Workflow",
                    automationConfig: "Automation Configuration",
                    branchStrategy: "Branching Strategy",
                    claudeHooks: "Claude Code Hooks",
                    cicdPipeline: "CI/CD Pipeline",
                    autoTesting: "Automated Testing",
                    qualityChecks: "Quality Checks",
                    generatePrompt: "Generate Prompt",
                    previewTitle: "Generated Prompt Preview",
                    copyToClipboard: "Copy to Clipboard",
                    downloadConfig: "Download Config",
                    generateProject: "Generate Project",
                    generating: "Generating...",
                    characters: "Characters:",
                    estimatedTokens: "Estimated Tokens:",
                    qualityScore: "Quality Score:",
                    copied: "Copied to clipboard!",
                    downloadSuccess: "Configuration downloaded successfully!"
                }
            },
            'zh-CN': {
                ui: {
                    title: "ğŸ¤– AIé¡¹ç›®ç”Ÿæˆå™¨",
                    subtitle: "ä¸ºClaude Codeç”Ÿæˆä¼˜åŒ–çš„æ–‡æ¡£é©±åŠ¨é¡¹ç›®å¼€å‘æç¤º",
                    configTitle: "é¡¹ç›®é…ç½®",
                    projectMode: "é¡¹ç›®æ¨¡å¼",
                    newProject: "æ–°å»ºé¡¹ç›®",
                    newProjectDesc: "(ç”Ÿæˆå®Œæ•´æ–‡æ¡£ä½“ç³»)",
                    versionIteration: "ç‰ˆæœ¬è¿­ä»£",
                    iterationDesc: "(åŸºäºç°æœ‰æ–‡æ¡£ç”Ÿæˆæ–°ç‰ˆæœ¬)",
                    versionSettings: "ç‰ˆæœ¬è®¾ç½®",
                    currentVersion: "å½“å‰ç‰ˆæœ¬",
                    targetVersion: "ç›®æ ‡ç‰ˆæœ¬",
                    changeType: "å˜æ›´ç±»å‹",
                    featureAddition: "åŠŸèƒ½å¢åŠ ",
                    featureModification: "åŠŸèƒ½ä¿®æ”¹",
                    architectureOptimization: "æ¶æ„ä¼˜åŒ–",
                    bugFix: "é”™è¯¯ä¿®å¤",
                    languageSettings: "è¯­è¨€è®¾ç½®",
                    docLanguage: "æ–‡æ¡£è¯­è¨€",
                    codeComments: "ä»£ç æ³¨é‡Š",
                    projectInfo: "é¡¹ç›®ä¿¡æ¯",
                    projectNamePlaceholder: "è¯·è¾“å…¥é¡¹ç›®åç§°...",
                    projectDescPlaceholder: "è¯·æè¿°æ‚¨çš„é¡¹ç›®éœ€æ±‚å’Œç›®æ ‡...",
                    webApp: "Webåº”ç”¨ç¨‹åº",
                    apiService: "APIæœåŠ¡",
                    mobileApp: "ç§»åŠ¨åº”ç”¨ç¨‹åº",
                    desktopApp: "æ¡Œé¢åº”ç”¨ç¨‹åº",
                    library: "åº“/æ¡†æ¶",
                    microservice: "å¾®æœåŠ¡",
                    documentsConfig: "æ–‡æ¡£é…ç½®",
                    coreDocuments: "æ ¸å¿ƒæ–‡æ¡£ï¼ˆå¿…éœ€ï¼‰",
                    professionalDocuments: "ä¸“ä¸šæ–‡æ¡£ï¼ˆå¯é€‰ï¼‰",
                    workflowDocuments: "å·¥ä½œæµæ–‡æ¡£ï¼ˆæ¨èï¼‰",
                    required: "å¿…éœ€",
                    recommended: "æ¨è",
                    optional: "å¯é€‰",
                    workflow: "å·¥ä½œæµ",
                    automationConfig: "è‡ªåŠ¨åŒ–é…ç½®",
                    branchStrategy: "åˆ†æ”¯ç­–ç•¥",
                    claudeHooks: "Claude Codeé’©å­",
                    cicdPipeline: "CI/CDæµæ°´çº¿",
                    autoTesting: "è‡ªåŠ¨åŒ–æµ‹è¯•",
                    qualityChecks: "è´¨é‡æ£€æŸ¥",
                    generatePrompt: "ç”Ÿæˆæç¤º",
                    previewTitle: "ç”Ÿæˆçš„æç¤ºé¢„è§ˆ",
                    copyToClipboard: "å¤åˆ¶åˆ°å‰ªè´´æ¿",
                    downloadConfig: "ä¸‹è½½é…ç½®",
                    generateProject: "ç”Ÿæˆé¡¹ç›®",
                    generating: "æ­£åœ¨ç”Ÿæˆ...",
                    characters: "å­—ç¬¦æ•°:",
                    estimatedTokens: "ä¼°è®¡ä»¤ç‰Œæ•°:",
                    qualityScore: "è´¨é‡è¯„åˆ†:",
                    copied: "å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼",
                    downloadSuccess: "é…ç½®ä¸‹è½½æˆåŠŸï¼"
                }
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            currentLang = detectLanguage();
            switchLanguage(currentLang);
            bindEvents();
            updatePreview();
        });

        // Language detection and switching
        function detectLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            return browserLang.startsWith('zh') ? 'zh-CN' : 'en';
        }

        function switchLanguage(lang) {
            currentLang = lang;
            updateLanguageUI();
            updateTexts();
            updatePreview();
        }

        function updateLanguageUI() {
            // Update active language button
            document.querySelectorAll('.language-switcher button').forEach(btn => {
                btn.classList.remove('bg-white/40');
                btn.classList.add('bg-white/20');
            });

            const activeBtn = currentLang === 'en' ? document.getElementById('lang-en') : document.getElementById('lang-zh');
            activeBtn.classList.remove('bg-white/20');
            activeBtn.classList.add('bg-white/40');
        }

        function updateTexts() {
            const texts = i18n[currentLang]?.ui || i18n['en'].ui;

            // Update main titles
            document.getElementById('main-title').textContent = texts.title;
            document.getElementById('main-subtitle').textContent = texts.subtitle;

            // Update form labels using data-i18n attributes
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (texts[key]) {
                    el.textContent = texts[key];
                }
            });

            // Update placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (texts[key]) {
                    el.placeholder = texts[key];
                }
            });

            // Update select options
            updateSelectOptions();
        }

        function updateSelectOptions() {
            const texts = i18n[currentLang]?.ui || i18n['en'].ui;

            // Update project type options
            const projectTypeSelect = document.getElementById('projectType');
            const options = projectTypeSelect.querySelectorAll('option');
            options.forEach(option => {
                const key = option.getAttribute('data-i18n');
                if (key && texts[key]) {
                    option.textContent = texts[key];
                }
            });

            // Update change type options
            const changeTypeSelect = document.getElementById('changeType');
            changeTypeSelect.querySelectorAll('option').forEach(option => {
                const key = option.getAttribute('data-i18n');
                if (key && texts[key]) {
                    option.textContent = texts[key];
                }
            });
        }

        // Event bindings
        function bindEvents() {
            // Form change listeners
            document.getElementById('project-form').addEventListener('change', updateConfig);
            document.getElementById('projectName').addEventListener('input', updateConfig);
            document.getElementById('projectDescription').addEventListener('input', updateConfig);

            // Project mode change listener
            document.querySelectorAll('input[name="projectMode"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const iterationSettings = document.getElementById('iteration-settings');
                    if (this.value === 'iteration') {
                        iterationSettings.classList.remove('hidden');
                    } else {
                        iterationSettings.classList.add('hidden');
                    }
                    updateConfig();
                });
            });

            // Auto-save configuration
            setInterval(autoSave, 5000); // Auto-save every 5 seconds
        }

        function updateConfig() {
            // Update project configuration from form
            const form = document.getElementById('project-form');
            const formData = new FormData(form);

            projectConfig = {
                mode: formData.get('projectMode') || 'new',
                name: document.getElementById('projectName').value,
                description: document.getElementById('projectDescription').value,
                type: document.getElementById('projectType').value,
                docLanguage: document.getElementById('docLanguage').value,
                codeComments: document.getElementById('codeComments').value,
                selectedDocs: Array.from(document.querySelectorAll('input[name="docs"]:checked')).map(cb => cb.value),
                branchStrategy: document.getElementById('branchStrategy').value,
                automation: Array.from(document.querySelectorAll('input[name="automation"]:checked')).map(cb => cb.value),
                currentVersion: document.getElementById('currentVersion').value,
                targetVersion: document.getElementById('targetVersion').value,
                changeType: document.getElementById('changeType').value
            };

            updateProgressBar();
            updatePreview();
        }

        function updateProgressBar() {
            let progress = 0;
            const maxProgress = 100;

            // Calculate progress based on filled fields
            if (projectConfig.name) progress += 20;
            if (projectConfig.description && projectConfig.description.length > 20) progress += 20;
            if (projectConfig.selectedDocs.length > 0) progress += 30;
            if (projectConfig.docLanguage) progress += 10;
            if (projectConfig.automation.length > 0) progress += 20;

            document.getElementById('progress-bar').style.width = `${Math.min(progress, maxProgress)}%`;
        }

        // Prompt generation with improved state management
        let isGenerating = false; // Prevent multiple simultaneous calls

        function generatePrompt() {
            // Prevent multiple calls while generating
            if (isGenerating) return;

            const generateBtn = document.getElementById('generate-btn');
            const loadingIndicator = document.getElementById('loading-indicator');

            try {
                isGenerating = true;

                // Update config first
                updateConfig();

                // Set loading state
                generateBtn.disabled = true;
                generateBtn.innerHTML = `
                    <svg class="w-5 h-5 animate-spin" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8z"/>
                    </svg>
                    <span>${currentLang === 'en' ? 'Generating...' : 'æ­£åœ¨ç”Ÿæˆ...'}</span>
                `;

                // Show loading overlay
                showLoading(true);

                // Generate prompt with timeout
                setTimeout(() => {
                    try {
                        const prompt = buildPrompt(projectConfig, currentLang);
                        document.getElementById('prompt-preview').textContent = prompt;
                        updateStats(prompt);

                        // Success feedback
                        showNotification(
                            currentLang === 'en' ? 'âœ… Prompt generated successfully!' : 'âœ… æç¤ºç”ŸæˆæˆåŠŸï¼',
                            'success'
                        );

                    } catch (error) {
                        console.error('Error generating prompt:', error);
                        showNotification(
                            currentLang === 'en' ? 'âŒ Error generating prompt' : 'âŒ ç”Ÿæˆæç¤ºæ—¶å‡ºé”™',
                            'error'
                        );
                    } finally {
                        // Always reset states
                        resetGenerateButton();
                    }
                }, 800);

            } catch (error) {
                console.error('Error in generatePrompt:', error);
                resetGenerateButton();
                showNotification(
                    currentLang === 'en' ? 'âŒ Error generating prompt' : 'âŒ ç”Ÿæˆæç¤ºæ—¶å‡ºé”™',
                    'error'
                );
            }
        }

        function resetGenerateButton() {
            try {
                isGenerating = false;
                showLoading(false);

                const generateBtn = document.getElementById('generate-btn');
                generateBtn.disabled = false;
                generateBtn.innerHTML = `
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M2.81 2.81L1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41L2.81 2.81zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20zM7.94 5.12L6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.45-1.45C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12z"/>
                    </svg>
                    <span data-i18n="generatePrompt">${i18n[currentLang].ui.generatePrompt}</span>
                `;
            } catch (error) {
                console.error('Error resetting button:', error);
                // Force reset as fallback
                isGenerating = false;
                document.getElementById('loading-indicator').classList.add('hidden');
                const btn = document.getElementById('generate-btn');
                if (btn) {
                    btn.disabled = false;
                    btn.textContent = 'Generate Prompt';
                }
            }
        }

        function buildPrompt(config, lang) {
            const isEn = lang === 'en';
            const isBilingual = config.docLanguage === 'bilingual';

            let prompt = `# Claude Code ${isEn ? 'Documentation-Driven Project Development Request' : 'æ–‡æ¡£é©±åŠ¨é¡¹ç›®å¼€å‘è¯·æ±‚'}\n\n`;

            prompt += `## <project_context>\n`;
            prompt += `**${isEn ? 'Project Mode' : 'é¡¹ç›®æ¨¡å¼'}**: ${config.mode === 'new' ? (isEn ? 'New Project' : 'æ–°å»ºé¡¹ç›®') : (isEn ? 'Version Iteration' : 'ç‰ˆæœ¬è¿­ä»£')}\n`;
            prompt += `**${isEn ? 'Project Name' : 'é¡¹ç›®åç§°'}**: ${config.name || (isEn ? 'My Project' : 'æˆ‘çš„é¡¹ç›®')}\n`;
            prompt += `**${isEn ? 'Project Type' : 'é¡¹ç›®ç±»å‹'}**: ${config.type}\n`;
            prompt += `**${isEn ? 'Documentation Language' : 'æ–‡æ¡£è¯­è¨€'}**: ${config.docLanguage}\n`;
            prompt += `**${isEn ? 'Code Comments Language' : 'ä»£ç æ³¨é‡Šè¯­è¨€'}**: ${config.codeComments}\n`;

            if (config.mode === 'iteration') {
                prompt += `**${isEn ? 'Current Version' : 'å½“å‰ç‰ˆæœ¬'}**: ${config.currentVersion}\n`;
                prompt += `**${isEn ? 'Target Version' : 'ç›®æ ‡ç‰ˆæœ¬'}**: ${config.targetVersion}\n`;
                prompt += `**${isEn ? 'Change Type' : 'å˜æ›´ç±»å‹'}**: ${config.changeType}\n`;
            }

            if (config.description) {
                prompt += `**${isEn ? 'Project Description' : 'é¡¹ç›®æè¿°'}**: ${config.description}\n`;
            }
            prompt += `\n`;

            if (isBilingual) {
                prompt += `## <multi_language_requirements>\n`;
                prompt += `- Generate bilingual documentation (English + Simplified Chinese)\n`;
                prompt += `- ç”ŸæˆåŒè¯­æ–‡æ¡£ï¼ˆè‹±æ–‡ + ç®€ä½“ä¸­æ–‡ï¼‰\n`;
                prompt += `- Use consistent terminology across languages è·¨è¯­è¨€ä½¿ç”¨ä¸€è‡´çš„æœ¯è¯­\n`;
                prompt += `- Include language switching capabilities åŒ…å«è¯­è¨€åˆ‡æ¢åŠŸèƒ½\n\n`;
            }

            prompt += `## <documentation_requirements>\n`;
            prompt += `### ${isEn ? 'Core Documents (Required)' : 'æ ¸å¿ƒæ–‡æ¡£ï¼ˆå¿…éœ€ï¼‰'}\n`;
            prompt += `1. **CLAUDE.md**: ${isEn ? 'Complete project configuration and development guide' : 'å®Œæ•´çš„é¡¹ç›®é…ç½®å’Œå¼€å‘æŒ‡å—'}\n`;
            prompt += `   - ${isEn ? 'Project overview and tech stack' : 'é¡¹ç›®æ¦‚è¿°å’ŒæŠ€æœ¯æ ˆ'}\n`;
            prompt += `   - ${isEn ? 'Development workflow and code standards' : 'å¼€å‘å·¥ä½œæµå’Œä»£ç æ ‡å‡†'}\n`;
            prompt += `   - ${isEn ? 'Claude Code usage guide' : 'Claude Codeä½¿ç”¨æŒ‡å—'}\n`;
            prompt += `   - ${isEn ? 'Documentation update standards' : 'æ–‡æ¡£æ›´æ–°è§„èŒƒ'}\n\n`;

            if (config.selectedDocs.includes('prd')) {
                prompt += `2. **PRD.md**: ${isEn ? 'Product requirements document' : 'äº§å“éœ€æ±‚æ–‡æ¡£'}\n`;
                prompt += `   - ${isEn ? 'Feature specifications' : 'åŠŸèƒ½è§„æ ¼è¯´æ˜'}\n`;
                prompt += `   - ${isEn ? 'User stories and acceptance criteria' : 'ç”¨æˆ·æ•…äº‹å’ŒéªŒæ”¶æ ‡å‡†'}\n`;
                prompt += `   - ${isEn ? 'Priority and milestone planning' : 'ä¼˜å…ˆçº§å’Œé‡Œç¨‹ç¢‘è§„åˆ’'}\n\n`;
            }

            if (config.selectedDocs.includes('architecture')) {
                prompt += `3. **ARCHITECTURE.md**: ${isEn ? 'System architecture document' : 'ç³»ç»Ÿæ¶æ„æ–‡æ¡£'}\n`;
                prompt += `   - ${isEn ? 'Overall architecture design' : 'æ•´ä½“æ¶æ„è®¾è®¡'}\n`;
                prompt += `   - ${isEn ? 'Technology selection explanation' : 'æŠ€æœ¯é€‰å‹è¯´æ˜'}\n`;
                prompt += `   - ${isEn ? 'Data flow and interface design' : 'æ•°æ®æµå’Œæ¥å£è®¾è®¡'}\n\n`;
            }

            if (config.selectedDocs.includes('api')) {
                prompt += `4. **API.md**: ${isEn ? 'Interface specification document' : 'æ¥å£è§„èŒƒæ–‡æ¡£'}\n`;
                prompt += `   - ${isEn ? 'RESTful API specifications' : 'RESTful APIè§„èŒƒ'}\n`;
                prompt += `   - ${isEn ? 'Data model definitions' : 'æ•°æ®æ¨¡å‹å®šä¹‰'}\n`;
                prompt += `   - ${isEn ? 'Error handling standards' : 'é”™è¯¯å¤„ç†æ ‡å‡†'}\n\n`;
            }

            // Add additional documents
            const additionalDocs = config.selectedDocs.filter(doc => !['prd', 'architecture', 'api'].includes(doc));
            if (additionalDocs.length > 0) {
                prompt += `### ${isEn ? 'Additional Documents' : 'é™„åŠ æ–‡æ¡£'}\n`;
                additionalDocs.forEach((doc, index) => {
                    const docNames = {
                        ux: 'UX.md',
                        security: 'SECURITY.md',
                        performance: 'PERFORMANCE.md',
                        deployment: 'DEPLOYMENT.md',
                        testing: 'TESTING.md',
                        development: 'DEVELOPMENT.md',
                        review: 'REVIEW.md'
                    };
                    prompt += `${index + 5}. **${docNames[doc]}**: ${isEn ? 'Specialized documentation' : 'ä¸“ä¸šæ–‡æ¡£'}\n`;
                });
                prompt += `\n`;
            }

            prompt += `## <automation_configuration>\n`;
            prompt += `### ${isEn ? 'Version Control Integration' : 'ç‰ˆæœ¬æ§åˆ¶é›†æˆ'}\n`;
            prompt += `- **${isEn ? 'Branching Strategy' : 'åˆ†æ”¯ç­–ç•¥'}**: ${config.branchStrategy}\n`;

            if (config.automation.includes('hooks')) {
                prompt += `- **Claude Code Hooks**: ${isEn ? 'Automated quality checks and workflows' : 'è‡ªåŠ¨åŒ–è´¨é‡æ£€æŸ¥å’Œå·¥ä½œæµ'}\n`;
            }

            if (config.automation.includes('cicd')) {
                prompt += `- **CI/CD Pipeline**: ${isEn ? 'Continuous integration and deployment' : 'æŒç»­é›†æˆå’Œéƒ¨ç½²'}\n`;
            }

            if (config.automation.includes('testing')) {
                prompt += `- **${isEn ? 'Automated Testing' : 'è‡ªåŠ¨åŒ–æµ‹è¯•'}**: ${isEn ? 'Unit, integration, and E2E tests' : 'å•å…ƒã€é›†æˆå’Œç«¯åˆ°ç«¯æµ‹è¯•'}\n`;
            }

            if (config.automation.includes('quality')) {
                prompt += `- **${isEn ? 'Quality Checks' : 'è´¨é‡æ£€æŸ¥'}**: ${isEn ? 'Code analysis and documentation sync' : 'ä»£ç åˆ†æå’Œæ–‡æ¡£åŒæ­¥'}\n`;
            }

            prompt += `\n`;

            if (config.mode === 'iteration') {
                prompt += `## <version_iteration>\n`;
                prompt += `${isEn ? 'Please perform incremental development based on version differences:' : 'è¯·åŸºäºç‰ˆæœ¬å·®å¼‚è¿›è¡Œå¢é‡å¼€å‘ï¼š'}\n`;
                prompt += `1. ${isEn ? `Analyze differences between ${config.currentVersion} and ${config.targetVersion}` : `åˆ†æ${config.currentVersion}å’Œ${config.targetVersion}çš„å·®å¼‚`}\n`;
                prompt += `2. ${isEn ? 'Update related code files' : 'æ›´æ–°ç›¸å…³ä»£ç æ–‡ä»¶'}\n`;
                prompt += `3. ${isEn ? 'Add/update test cases' : 'æ·»åŠ /æ›´æ–°æµ‹è¯•ç”¨ä¾‹'}\n`;
                prompt += `4. ${isEn ? 'Update documentation versions' : 'æ›´æ–°æ–‡æ¡£ç‰ˆæœ¬'}\n`;
                prompt += `5. ${isEn ? 'Generate change report' : 'ç”Ÿæˆå˜æ›´æŠ¥å‘Š'}\n\n`;
            } else {
                prompt += `## <project_generation>\n`;
                prompt += `${isEn ? 'Please generate a complete project structure including:' : 'è¯·ç”Ÿæˆå®Œæ•´çš„é¡¹ç›®ç»“æ„ï¼ŒåŒ…æ‹¬ï¼š'}\n`;
                prompt += `1. ${isEn ? 'Complete source code implementation' : 'å®Œæ•´çš„æºä»£ç å®ç°'}\n`;
                prompt += `2. ${isEn ? 'Versioned documentation system (docs/versions/v1.0/)' : 'ç‰ˆæœ¬åŒ–æ–‡æ¡£ä½“ç³» (docs/versions/v1.0/)'}\n`;
                prompt += `3. ${isEn ? 'Testing framework and sample tests' : 'æµ‹è¯•æ¡†æ¶å’Œç¤ºä¾‹æµ‹è¯•'}\n`;
                prompt += `4. ${isEn ? 'CI/CD configuration files' : 'CI/CDé…ç½®æ–‡ä»¶'}\n`;
                prompt += `5. ${isEn ? 'Development environment configuration' : 'å¼€å‘ç¯å¢ƒé…ç½®'}\n`;
                prompt += `6. ${isEn ? 'Claude Code integration setup' : 'Claude Codeé›†æˆè®¾ç½®'}\n\n`;
            }

            prompt += `## <quality_standards>\n`;
            prompt += `### ${isEn ? 'Code Quality Requirements' : 'ä»£ç è´¨é‡è¦æ±‚'}\n`;
            prompt += `- **${isEn ? 'Type Safety' : 'ç±»å‹å®‰å…¨'}**: ${isEn ? 'Use TypeScript for type safety' : 'ä½¿ç”¨TypeScriptç¡®ä¿ç±»å‹å®‰å…¨'}\n`;
            prompt += `- **${isEn ? 'Code Standards' : 'ä»£ç è§„èŒƒ'}**: ${isEn ? 'Follow ESLint and Prettier standards' : 'éµå¾ªESLintå’ŒPrettierè§„èŒƒ'}\n`;
            prompt += `- **${isEn ? 'Test Coverage' : 'æµ‹è¯•è¦†ç›–'}**: ${isEn ? 'Unit test coverage â‰¥80%' : 'å•å…ƒæµ‹è¯•è¦†ç›–ç‡â‰¥80%'}\n`;
            prompt += `- **${isEn ? 'Documentation Sync' : 'æ–‡æ¡£åŒæ­¥'}**: ${isEn ? 'Code changes must sync documentation updates' : 'ä»£ç å˜æ›´å¿…é¡»åŒæ­¥æ›´æ–°æ–‡æ¡£'}\n\n`;

            prompt += `### ${isEn ? 'Documentation Quality Requirements' : 'æ–‡æ¡£è´¨é‡è¦æ±‚'}\n`;
            prompt += `- **${isEn ? 'Complete Structure' : 'ç»“æ„å®Œæ•´'}**: ${isEn ? 'All documents include complete chapter structure' : 'æ‰€æœ‰æ–‡æ¡£åŒ…å«å®Œæ•´çš„ç« èŠ‚ç»“æ„'}\n`;
            prompt += `- **${isEn ? 'Professional Content' : 'å†…å®¹ä¸“ä¸š'}**: ${isEn ? 'Accurate technical descriptions, clear user stories' : 'æŠ€æœ¯æè¿°å‡†ç¡®ï¼Œç”¨æˆ·æ•…äº‹æ¸…æ™°'}\n`;
            prompt += `- **${isEn ? 'Version Consistency' : 'ç‰ˆæœ¬ä¸€è‡´'}**: ${isEn ? 'Documentation versions stay synchronized with code versions' : 'æ–‡æ¡£ç‰ˆæœ¬ä¸ä»£ç ç‰ˆæœ¬ä¿æŒåŒæ­¥'}\n`;
            prompt += `- **${isEn ? 'Executability' : 'å¯æ‰§è¡Œæ€§'}**: ${isEn ? 'All workflows can be directly executed' : 'æ‰€æœ‰å·¥ä½œæµç¨‹å¯ç›´æ¥æ‰§è¡Œ'}\n\n`;

            if (isBilingual) {
                prompt += `### ${isEn ? 'Multi-language Quality Standards' : 'å¤šè¯­è¨€è´¨é‡æ ‡å‡†'}\n`;
                prompt += `- **${isEn ? 'Translation Accuracy' : 'ç¿»è¯‘å‡†ç¡®æ€§'}**: ${isEn ? 'Technical terms consistently translated' : 'æŠ€æœ¯æœ¯è¯­ä¸€è‡´ç¿»è¯‘'}\n`;
                prompt += `- **${isEn ? 'Cultural Adaptation' : 'æ–‡åŒ–é€‚åº”'}**: ${isEn ? 'Content adapted for target language culture' : 'å†…å®¹é€‚åº”ç›®æ ‡è¯­è¨€æ–‡åŒ–'}\n`;
                prompt += `- **${isEn ? 'Consistency' : 'ä¸€è‡´æ€§'}**: ${isEn ? 'Terminology consistent across all documents' : 'æœ¯è¯­åœ¨æ‰€æœ‰æ–‡æ¡£ä¸­ä¿æŒä¸€è‡´'}\n`;
                prompt += `- **${isEn ? 'Completeness' : 'å®Œæ•´æ€§'}**: ${isEn ? 'All selected languages have complete documentation' : 'æ‰€æœ‰é€‰æ‹©çš„è¯­è¨€éƒ½æœ‰å®Œæ•´æ–‡æ¡£'}\n\n`;
            }

            prompt += `## <success_criteria>\n`;
            prompt += `### ${isEn ? 'Project Delivery Standards' : 'é¡¹ç›®äº¤ä»˜æ ‡å‡†'}\n`;
            prompt += `- [x] ${isEn ? 'Code runs directly, passes all tests' : 'ä»£ç å¯ç›´æ¥è¿è¡Œï¼Œé€šè¿‡æ‰€æœ‰æµ‹è¯•'}\n`;
            prompt += `- [x] ${isEn ? 'Complete documentation system, supports version management' : 'æ–‡æ¡£ä½“ç³»å®Œæ•´ï¼Œæ”¯æŒç‰ˆæœ¬åŒ–ç®¡ç†'}\n`;
            prompt += `- [x] ${isEn ? 'Git workflow configured, supports automation' : 'Gitå·¥ä½œæµé…ç½®å®Œæˆï¼Œæ”¯æŒè‡ªåŠ¨åŒ–'}\n`;
            prompt += `- [x] ${isEn ? 'Claude Code integration configured, supports incremental development' : 'Claude Codeé›†æˆé…ç½®ï¼Œæ”¯æŒå¢é‡å¼€å‘'}\n`;
            prompt += `- [x] ${isEn ? 'CI/CD pipeline ready, supports continuous integration' : 'CI/CDæµç¨‹å°±ç»ªï¼Œæ”¯æŒæŒç»­é›†æˆ'}\n`;

            if (isBilingual) {
                prompt += `- [x] ${isEn ? 'Multi-language support implemented' : 'å¤šè¯­è¨€æ”¯æŒå·²å®ç°'}\n`;
            }

            prompt += `\n${isEn ? 'Please generate a complete, production-ready project based on these requirements with excellent maintainability, Claude Code integration capabilities, and comprehensive documentation system.' : 'è¯·åŸºäºè¿™äº›è¦æ±‚ç”Ÿæˆå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„é¡¹ç›®ï¼Œç¡®ä¿é¡¹ç›®å…·å¤‡ä¼˜ç§€çš„å¯ç»´æŠ¤æ€§ã€Claude Codeé›†æˆèƒ½åŠ›å’Œå…¨é¢çš„æ–‡æ¡£ä½“ç³»ã€‚'}`;

            return prompt;
        }

        function updatePreview() {
            // Remove auto-update to prevent always showing generating state
            // Users now need to manually click Generate Prompt button
            const preview = document.getElementById('prompt-preview');
            const currentText = preview.textContent;

            // Only update if it's still showing the default message
            if (currentText.includes('Click "Generate Prompt"') || currentText.includes('ç‚¹å‡»"ç”Ÿæˆæç¤º"')) {
                // Keep the default message
                return;
            }
        }

        function updateStats(text) {
            const charCount = text.length;
            const tokenCount = Math.ceil(charCount / 4); // Rough estimate
            const qualityScore = calculateQualityScore(projectConfig);

            document.getElementById('char-count').textContent = charCount.toLocaleString();
            document.getElementById('token-count').textContent = tokenCount.toLocaleString();
            document.getElementById('quality-score').textContent = qualityScore;
        }

        function calculateQualityScore(config) {
            let score = 60; // Base score

            if (config.name && config.name.length > 3) score += 10;
            if (config.description && config.description.length > 50) score += 15;
            if (config.selectedDocs.length >= 3) score += 10;
            if (config.selectedDocs.length >= 5) score += 5;
            if (config.docLanguage === 'bilingual') score += 5;
            if (config.automation.length >= 3) score += 5;

            return Math.min(score, 100);
        }

        function showLoading(show) {
            try {
                const indicator = document.getElementById('loading-indicator');
                if (!indicator) {
                    console.error('Loading indicator not found');
                    return;
                }

                if (show) {
                    indicator.classList.remove('hidden');
                    indicator.style.display = 'flex'; // Force display
                } else {
                    indicator.classList.add('hidden');
                    indicator.style.display = 'none'; // Force hide
                }
            } catch (error) {
                console.error('Error in showLoading:', error);
            }
        }

        // Utility functions
        function copyPrompt() {
            const prompt = document.getElementById('prompt-preview').textContent;
            navigator.clipboard.writeText(prompt).then(() => {
                showNotification(i18n[currentLang].ui.copied, 'success');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = prompt;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification(i18n[currentLang].ui.copied, 'success');
            });
        }

        function downloadConfig() {
            const config = {
                ...projectConfig,
                language: currentLang,
                timestamp: new Date().toISOString(),
                version: '1.0.0'
            };

            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${(config.name || 'project').replace(/\s+/g, '-').toLowerCase()}-config.json`;
            a.click();
            URL.revokeObjectURL(url);

            showNotification(i18n[currentLang].ui.downloadSuccess, 'success');
        }

        function generateProject() {
            const prompt = document.getElementById('prompt-preview').textContent;
            if (!prompt || prompt.includes('Click "Generate Prompt"')) {
                showNotification(currentLang === 'en' ? 'Please generate a prompt first!' : 'è¯·å…ˆç”Ÿæˆæç¤ºï¼', 'error');
                return;
            }

            // Copy prompt and show instructions
            copyPrompt();
            showNotification(
                currentLang === 'en'
                    ? 'Prompt copied! Paste it into Claude Code to generate your project.'
                    : 'æç¤ºå·²å¤åˆ¶ï¼è¯·ç²˜è´´åˆ°Claude Codeä¸­ç”Ÿæˆæ‚¨çš„é¡¹ç›®ã€‚',
                'info'
            );
        }

        function autoSave() {
            const config = {
                ...projectConfig,
                language: currentLang,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('claudeProjectConfig', JSON.stringify(config));
        }

        function loadSavedConfig() {
            const saved = localStorage.getItem('claudeProjectConfig');
            if (saved) {
                try {
                    const config = JSON.parse(saved);
                    projectConfig = { ...projectConfig, ...config };
                    // Restore form values
                    restoreFormValues();
                } catch (e) {
                    console.warn('Failed to load saved configuration:', e);
                }
            }
        }

        function restoreFormValues() {
            // Restore form values from projectConfig
            document.getElementById('projectName').value = projectConfig.name || '';
            document.getElementById('projectDescription').value = projectConfig.description || '';
            document.getElementById('projectType').value = projectConfig.type || 'web';
            document.getElementById('docLanguage').value = projectConfig.docLanguage || 'en';
            document.getElementById('codeComments').value = projectConfig.codeComments || 'en';

            // Restore checkboxes
            projectConfig.selectedDocs.forEach(doc => {
                const checkbox = document.querySelector(`input[name="docs"][value="${doc}"]`);
                if (checkbox) checkbox.checked = true;
            });

            projectConfig.automation.forEach(auto => {
                const checkbox = document.querySelector(`input[name="automation"][value="${auto}"]`);
                if (checkbox) checkbox.checked = true;
            });
        }

        function showNotification(message, type = 'info') {
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(n => n.remove());

            // Create and show notification
            const notification = document.createElement('div');
            notification.className = `notification px-6 py-3 rounded-lg text-white z-50 fade-in ${
                type === 'success' ? 'bg-green-500' :
                type === 'error' ? 'bg-red-500' :
                'bg-blue-500'
            }`;
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Load saved configuration on startup
        loadSavedConfig();

        // Initialize preview on load
        updatePreview();
    </script>
</body>
</html>